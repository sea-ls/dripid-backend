x-logging: &default-logging
  driver: json-file
  options:
    max-size: 10m
    tag: "{{.Name}}"

x-low-prior-service-limitation: &resources-low
  memory: '1G'

x-service-limitation: &resources-high
  memory: '3G'

x-health-check: &actuator-health-check
  test: "curl --fail --silent localhost:8080/api/actuator/health | grep UP || exit 1"
  interval: 20s
  timeout: 5s
  retries: 6
  start_period: 10m

x-java-low-resource-reservation: &reservation-low
  reservations:
    memory: 700M
  limits:
    memory: 1G

x-update-config: &update-config-30s
  monitor: 30s
  order: start-first

x-environment: &environment
  JAVA_TOOL_OPTIONS: -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005 -Dnetworkaddress.cache.ttl=60 -Dsun.net.inetaddr.ttl=60

x-default-spring-service-configuration: &default-spring-config
  stop_grace_period: 1m
  logging: *default-logging
  healthcheck: *actuator-health-check
  deploy: &default-spring-deploy
    resources: *reservation-low
    update_config: *update-config-30s
  environment: *environment
